<!DOCTYPE html>
<html>

<head>
    <title>Carchive</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
        }

        .image-grid {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .image-card {
            width: 18%;
            min-width: 180px;
        }

        .card {
            text-decoration: none;
            color: inherit;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s;
        }

        .card:hover {
            transform: translateY(-5px);
        }

        .card-img-top {
            width: 100%;
            height: auto;
        }

        .tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 5px;
        }

        .tag {
            background-color: #007bff;
            color: white;
            font-size: 0.75em;
            padding: 2px 6px;
            border-radius: 3px;
            display: inline-block;
        }

        .navbar-margin {
            margin-bottom: 20px;
        }

        /* Responsive Layout */
        @media (max-width: 768px) {
            .image-card {
                width: 45%;
            }
        }

        @media (max-width: 480px) {
            .image-card {
                width: 40%;
            }
        }
    </style>
</head>

<body>
    <!-- Top Navbar -->
    <nav class="navbar navbar-dark bg-dark navbar-margin">
        <a class="navbar-brand" href="#">Carchive</a>
        <form class="form-inline" onsubmit="handleSearch(event)">
            <input class="form-control mr-sm-2" id="tagsInput" type="search" placeholder="Search tags"
                aria-label="Search">
            <button class="btn btn-outline-success my-2 my-sm-0" type="submit">Search</button>
        </form>
    </nav>

    <div class="image-grid" id="imageGrid"></div>

    <script>
        async function fetchImages(tags) {
            const query = tags || '';
            const url = query ? '/images?tags=' + encodeURIComponent(query) : '/images';
            const response = await fetch(url);
            const images = await response.json();
            const grid = document.getElementById('imageGrid');
            grid.innerHTML = '';
            if (images.length === 0) {
                grid.innerHTML = '<p>No images found.</p>';
                return;
            }

            images.forEach(img => {
                const div = document.createElement('div');
                div.className = 'image-card';
                div.innerHTML = `
                    <a href="${img.url}" target="_blank" class="card">
                        <img class="card-img-top" src="${img.url}" alt="${img.public_id}">
                        <div class="card-body">
                            <h5 class="card-title">${img.title}</h5>
                            <div class="tags">
                                ${img.tags.map(tag => `<span class="tag">${tag}</span>`).join('')}
                            </div>
                        </div>
                    </a>
                `;
                grid.appendChild(div);
            });
        }

        function handleSearch(event) {
            event.preventDefault();
            const tags = document.getElementById('tagsInput').value;
            fetchImages(tags);
        }

        // Load all images on page load
        fetchImages();
    </script>

    <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js"
        integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js"
        integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.4.1/dist/js/bootstrap.min.js"
        integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6"
        crossorigin="anonymous"></script>
</body>

</html>
